[
    {
        "case_id": "RWA-SYN-001",
        "vulnerability_type": "Compliance Bypass (KYC/AML)",
        "description": "The transfer function lacks a check against the KYC/AML whitelist before allowing token transfer to a new address, violating regulatory requirements for security tokens.",
        "severity": "Critical",
        "affected_contract_type": "TSMC2330",
        "mitigation_suggestion": "Implement a `require(isCompliant(to))` check in the `_transfer` function."
    },
    {
        "case_id": "RWA-SYN-002",
        "vulnerability_type": "Asset Mapping Error (Off-Chain Status)",
        "description": "The contract's `pause` mechanism is not automatically triggered when the off-chain asset's legal status changes (e.g., stock trading halt), leading to a disconnect between on-chain and off-chain reality.",
        "severity": "Critical",
        "affected_contract_type": "LARGAN3008",
        "mitigation_suggestion": "Integrate an off-chain oracle to push trading status and automatically call `_pause()`."
    },
    {
        "case_id": "RWA-SYN-003",
        "vulnerability_type": "Oracle Manipulation (Stale Price)",
        "description": "The `getTw50Price` function uses the Chainlink price feed without checking the `updatedAt` timestamp, making it vulnerable to stale price attacks during network congestion or oracle failure.",
        "severity": "High",
        "affected_contract_type": "TW50",
        "mitigation_suggestion": "Add a check: `require(updatedAt >= block.timestamp - MAX_DELAY, 'Stale price feed')`."
    },
    {
        "case_id": "RWA-SYN-004",
        "vulnerability_type": "Business Logic Flaw (Collateral Ratio)",
        "description": "The collateral calculation for liquidation uses an integer division that rounds down, allowing a user to slightly under-collateralize without triggering the liquidation threshold.",
        "severity": "Medium",
        "affected_contract_type": "AAPL_Collateralized",
        "mitigation_suggestion": "Use SafeMath or a fixed-point arithmetic library for all financial calculations."
    },
    {
        "case_id": "RWA-SYN-005",
        "vulnerability_type": "Compliance Bypass (Jurisdiction)",
        "description": "The contract allows minting to addresses from a blacklisted jurisdiction (determined by IP/KYC data) because the `onlyIssuer` modifier is bypassed in a secondary minting function.",
        "severity": "Critical",
        "affected_contract_type": "TSMC2330",
        "mitigation_suggestion": "Ensure all minting paths are protected by the primary compliance check."
    },
    {
        "case_id": "RWA-SYN-006",
        "vulnerability_type": "Asset Mapping Error (Redemption Lock)",
        "description": "The `burn` function allows token redemption even if the underlying physical asset is currently locked in a legal dispute, leading to a potential double-claim scenario.",
        "severity": "Critical",
        "affected_contract_type": "LARGAN3008",
        "mitigation_suggestion": "Implement a state variable check tied to the off-chain legal status before allowing burn/redemption."
    },
    {
        "case_id": "RWA-SYN-007",
        "vulnerability_type": "Oracle Manipulation (Incorrect Scaling)",
        "description": "The price feed scaling factor is incorrectly applied, leading to a 10x error in the token's valuation and subsequent over/under-collateralization.",
        "severity": "High",
        "affected_contract_type": "TW50",
        "mitigation_suggestion": "Review and correct the scaling logic in `getTw50Price`."
    },
    {
        "case_id": "RWA-SYN-008",
        "vulnerability_type": "Access Control (Issuer Key Compromise)",
        "description": "The `onlyIssuer` modifier is used, but the issuer key is a simple EOA without multi-sig protection, representing a single point of failure for the entire RWA system.",
        "severity": "Medium",
        "affected_contract_type": "All RWA Contracts",
        "mitigation_suggestion": "Migrate the `issuer` role to a multi-signature wallet (e.g., Gnosis Safe)."
    },
    {
        "case_id": "RWA-SYN-009",
        "vulnerability_type": "Business Logic Flaw (Dividend Distribution)",
        "description": "The contract's dividend distribution logic fails to account for tokens held in the contract itself, leading to an incorrect distribution ratio for token holders.",
        "severity": "Medium",
        "affected_contract_type": "TSMC2330",
        "mitigation_suggestion": "Ensure dividend calculation excludes the contract's own balance."
    },
    {
        "case_id": "RWA-SYN-010",
        "vulnerability_type": "Asset Mapping Error (Fractionalization Limit)",
        "description": "The contract allows fractionalization beyond the legal limit defined in the off-chain legal agreement, creating a legal risk.",
        "severity": "High",
        "affected_contract_type": "LARGAN3008",
        "mitigation_suggestion": "Implement a hard cap on the total supply based on the legal fractionalization limit."
    },
    {
        "case_id": "RWA-SYN-011",
        "vulnerability_type": "Compliance Bypass (Sanctions List)",
        "description": "The contract's `isCompliant` function does not check against a dynamic sanctions list, allowing a sanctioned address to hold tokens.",
        "severity": "Critical",
        "affected_contract_type": "TW50",
        "mitigation_suggestion": "Integrate a reputable on-chain sanctions screening service."
    },
    {
        "case_id": "RWA-SYN-012",
        "vulnerability_type": "Oracle Manipulation (Medianizer Attack)",
        "description": "The contract relies on a single oracle source instead of a decentralized medianizer, making it susceptible to a single point of failure and manipulation.",
        "severity": "High",
        "affected_contract_type": "All RWA Contracts",
        "mitigation_suggestion": "Switch to a robust, decentralized oracle network with multiple data providers."
    },
    {
        "case_id": "RWA-SYN-013",
        "vulnerability_type": "Business Logic Flaw (Fee Calculation)",
        "description": "The fee calculation for redemption uses a percentage that is hardcoded and cannot be updated, making the system inflexible to changing market conditions or regulatory fees.",
        "severity": "Low",
        "affected_contract_type": "TSMC2330",
        "mitigation_suggestion": "Make the fee percentage a state variable that can be updated by the issuer."
    },
    {
        "case_id": "RWA-SYN-014",
        "vulnerability_type": "Asset Mapping Error (Metadata Mismatch)",
        "description": "The ERC20 metadata (name/symbol) is hardcoded and does not reflect potential off-chain changes (e.g., company name change or stock split), leading to investor confusion.",
        "severity": "Low",
        "affected_contract_type": "LARGAN3008",
        "mitigation_suggestion": "Consider using a dynamic metadata standard or ensuring off-chain changes are reflected on-chain."
    },
    {
        "case_id": "RWA-SYN-015",
        "vulnerability_type": "Compliance Bypass (Minimum Holding)",
        "description": "The contract fails to enforce a regulatory minimum holding period or amount for certain investor classes, violating specific securities laws.",
        "severity": "Medium",
        "affected_contract_type": "TW50",
        "mitigation_suggestion": "Implement a mapping to track holding time and enforce minimum holding rules in `_transfer`."
    },
    {
        "case_id": "RWA-SYN-016",
        "vulnerability_type": "Business Logic Flaw (Emergency Shutdown)",
        "description": "The contract lacks an emergency shutdown or circuit breaker mechanism to halt operations in case of a catastrophic off-chain event or market crash.",
        "severity": "High",
        "affected_contract_type": "All RWA Contracts",
        "mitigation_suggestion": "Implement a `whenNotPaused` modifier and an `emergencyShutdown` function callable by the issuer."
    },
    {
        "case_id": "RWA-SYN-017",
        "vulnerability_type": "Asset Mapping Error (Redemption Priority)",
        "description": "The redemption queue logic (if implemented) is susceptible to front-running, allowing privileged users to redeem before others during a liquidity crunch.",
        "severity": "Medium",
        "affected_contract_type": "AAPL_Collateralized",
        "mitigation_suggestion": "Use a fair-ordering mechanism or batch processing for redemptions."
    },
    {
        "case_id": "RWA-SYN-018",
        "vulnerability_type": "Oracle Manipulation (Price Smoothing)",
        "description": "The contract uses the raw latest price instead of a time-weighted average price (TWAP), making it vulnerable to flash loan price manipulation.",
        "severity": "Critical",
        "affected_contract_type": "TSMC2330",
        "mitigation_suggestion": "Implement a TWAP mechanism using historical data for critical functions."
    },
    {
        "case_id": "RWA-SYN-019",
        "vulnerability_type": "Compliance Bypass (Transfer Restriction)",
        "description": "A specific regulatory rule requires tokens to only be transferable to other whitelisted addresses, but the `_transfer` function is public and unrestricted.",
        "severity": "Critical",
        "affected_contract_type": "LARGAN3008",
        "mitigation_suggestion": "Modify `_transfer` to check if both `from` and `to` are whitelisted."
    },
    {
        "case_id": "RWA-SYN-020",
        "vulnerability_type": "Business Logic Flaw (Interest Calculation)",
        "description": "The interest accrual logic (if applicable) uses `block.timestamp` instead of a reliable time source, which can be manipulated by miners.",
        "severity": "Medium",
        "affected_contract_type": "TW50",
        "mitigation_suggestion": "Use a time-based oracle or a more robust time-tracking mechanism."
    },
    {
        "case_id": "RWA-SYN-021",
        "vulnerability_type": "Asset Mapping Error (Voting Rights)",
        "description": "The token does not correctly delegate or reflect the underlying stock's voting rights, leading to a governance failure.",
        "severity": "Low",
        "affected_contract_type": "TSMC2330",
        "mitigation_suggestion": "Implement a voting delegation mechanism (e.g., ERC-20 Votes)."
    },
    {
        "case_id": "RWA-SYN-022",
        "vulnerability_type": "Compliance Bypass (Investor Cap)",
        "description": "The contract fails to enforce a regulatory limit on the maximum number of tokens any single investor can hold.",
        "severity": "Medium",
        "affected_contract_type": "LARGAN3008",
        "mitigation_suggestion": "Check the investor's balance against the maximum allowed limit in `_mint` and `_transfer`."
    },
    {
        "case_id": "RWA-SYN-023",
        "vulnerability_type": "Oracle Manipulation (Fallback Price)",
        "description": "The contract's fallback mechanism for a failed price feed is a hardcoded, outdated price, which can be exploited when the oracle is down.",
        "severity": "High",
        "affected_contract_type": "TW50",
        "mitigation_suggestion": "Implement a robust, multi-layered fallback mechanism (e.g., circuit breaker or governance-set price)."
    },
    {
        "case_id": "RWA-SYN-024",
        "vulnerability_type": "Business Logic Flaw (Emergency Fee)",
        "description": "An emergency fee can be set by the issuer without any time lock or governance delay, allowing for immediate, potentially malicious, fee extraction.",
        "severity": "Medium",
        "affected_contract_type": "All RWA Contracts",
        "mitigation_suggestion": "Implement a time lock for critical parameter changes."
    },
    {
        "case_id": "RWA-SYN-025",
        "vulnerability_type": "Asset Mapping Error (Off-Chain Fee Mismatch)",
        "description": "The on-chain fee for redemption does not match the actual off-chain legal/brokerage fee, leading to a financial discrepancy.",
        "severity": "Low",
        "affected_contract_type": "AAPL_Collateralized",
        "mitigation_suggestion": "Ensure the on-chain fee parameter is regularly synchronized with the off-chain legal document."
    }
]
